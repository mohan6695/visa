name = "visa-clustering-worker"
main = "workers/clustering.ts"
compatibility_date = "2026-01-16"
compatibility_flags = ["nodejs_compat"]

# Cron triggers for automatic clustering
[triggers]
crons = ["*/15 * * * *"]  # Run every 15 minutes

# Production environment
[env.production]
vars = { ENVIRONMENT = "production" }

# Development environment  
[env.development]
vars = { ENVIRONMENT = "development" }

# Secrets (set via: wrangler secret put SECRET_NAME)
# Required secrets:
# - SUPABASE_URL
# - SUPABASE_SERVICE_ROLE_KEY
# - CF_ACCOUNT_ID
# - CF_API_TOKEN

# Resources
[[kv_namespaces]]
binding = "SESSION"
id = "5efb3f36000f4319ab0e926229da7b9d"

[[r2_buckets]]
binding = "MY_BUCKET"
bucket_name = "data-pipeline"

[ai]
binding = "AI"
