"""
Test script to verify Qwen model integration with KiloCode
"""
import requests
import json

OLLAMA_BASE_URL = "http://localhost:11434"

def test_qwen_model():
    """Test the Qwen 2.5 model with a simple prompt"""
    url = f"{OLLAMA_BASE_URL}/api/generate"
    
    payload = {
        "model": "qwen2.5:3b",
        "prompt": "What is the capital of France?",
        "stream": False
    }
    
    try:
        response = requests.post(url, json=payload)
        response.raise_for_status()
        result = response.json()
        
        print("✅ Qwen Model Test Successful!")
        print(f"Response: {result.get('response', 'No response')}")
        return True
    except requests.exceptions.RequestException as e:
        print(f"❌ Error: {e}")
        return False

def test_ollama_chat():
    """Test using the chat completions API"""
    url = f"{OLLAMA_BASE_URL}/api/chat"
    
    payload = {
        "model": "qwen2.5:3b",
        "messages": [
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": "Explain quantum computing in simple terms"}
        ],
        "stream": False
    }
    
    try:
        response = requests.post(url, json=payload)
        response.raise_for_status()
        result = response.json()
        
        print("\n✅ Chat API Test Successful!")
        print(f"Response: {result.get('message', {}).get('content', 'No response')}")
        return True
    except requests.exceptions.RequestException as e:
        print(f"❌ Error: {e}")
        return False

if __name__ == "__main__":
    print("Testing Ollama Qwen Model Integration...\n")
    test_qwen_model()
    test_ollama_chat()
